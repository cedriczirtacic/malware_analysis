doc = Document.getCurrentDocument()
'''
usually found at:
00000000004000ec         db  0x55 ; 'U'
00000000004000ed         db  0x50 ; 'P'
00000000004000ee         db  0x58 ; 'X'
00000000004000ef         db  0x21 ; '!'
'''
magic_addr = int(doc.getSegment(0).getStartingAddress()) + 0xec
magic = doc.readBytes(magic_addr,4)
if str(magic) == "UPX!":
	print "[+] Seems to be packed with UPX."
	doc.moveCursorAtAddress(magic_addr)
else:
	print "[-] Not packed with UPX?"

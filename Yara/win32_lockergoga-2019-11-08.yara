// SHA256: c97d9bbc80b573bdeeda3812f4d00e5183493dd0d5805e2508728f65977dda15
import "pe"

rule win32_lockergoga {
	meta:
		author = "cedric"
		description = "LockerGoga detection rules"
		date = "2019-11-08"
	strings:
		$str0 = "DharmaParrack@protonmail.com" fullword ascii
		$str1 = "wyattpettigrew8922555@mail.com" fullword ascii
		$str2 = "README_LOCKED.txt" fullword ascii
		$str3 = ".locked" wide
	condition:
		( uint16(0) == 0x5A4D and 
			pe.imports("CryptGenRandom") ) or all of them
}